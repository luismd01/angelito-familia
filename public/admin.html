<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Admin - Angelito Familiar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-dark-admin">

  <div class="container py-4">
    <h1 class="text-center text-light mb-4">Panel de Administraci√≥n üéÑ</h1>
    <p class="text-center text-muted mb-4">
      Aqu√≠ puedes ver qui√©n fue asignado a qui√©n.
    </p>

    <div class="table-responsive">
      <table class="table table-dark table-striped align-middle">
        <thead>
          <tr>
            <th>#</th>
            <th>Nombre</th>
            <th>C√≥digo</th>
            <th>¬øYa eligi√≥?</th>
            <th>Angelito asignado</th>
          </tr>
        </thead>
        <tbody id="adminTableBody"></tbody>
      </table>
    </div>

    <div class="text-end mt-3">
      <a href="/" class="btn btn-outline-light">Volver a la p√°gina principal</a>
    </div>
  </div>

  <script>
    async function loadAdminData() {
      const tbody = document.getElementById("adminTableBody");
      tbody.innerHTML = "";

      try {
        const res = await fetch("/api/admin-data");
        const data = await res.json();

        data.forEach((p, index) => {
          const tr = document.createElement("tr");

          tr.innerHTML = `
            <td>${index + 1}</td>
            <td>${p.name}</td>
            <td><code>${p.code}</code></td>
            <td>${p.hasPicked ? "‚úÖ S√≠" : "‚ùå No"}</td>
            <td>${p.angelito ? p.angelito : "<span class='text-warning'>Pendiente</span>"}</td>
          `;

          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error(error);
        tbody.innerHTML = `
          <tr>
            <td colspan="5" class="text-center text-danger">
              Error cargando datos. Revisa el servidor.
            </td>
          </tr>
        `;
      }
    }

    loadAdminData();
  </script>
</body>
</html>